using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Services;

using System.Web.Security;

using ProductListDBModel;
using System.Data.SqlClient;

/// <summary>
/// Summary description for WSProductList
/// </summary>
[WebService(Namespace = "http://tempuri.org/")]
[WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
// To allow this Web Service to be called from script, using ASP.NET AJAX, uncomment the following line. 
// [System.Web.Script.Services.ScriptService]
public class WSProductList : System.Web.Services.WebService {
    
    ProdListDBEntities myDBhandler = DBHandler.GetInstance();
    int userID = 0;
    
            

    public WSProductList () {

        //Uncomment the following line if using designed components 
        //InitializeComponent(); 
    }

   /* private void getCurrentUser() {
        if (userID !=0)
        {
           // System.Web.HttpContext.Current.Request.Cookies["HRU"].Value = "Oinki Oinki";
            userID = 78;
        }
        else
        {
           // System.Web.HttpContext.Current.Request.Cookies["HRU"].Value = "Oink";
            if (System.Web.HttpContext.Current.Request.Cookies["UserIdNew"] != null)
            {
             
                userID = Convert.ToInt16(System.Web.HttpContext.Current.Request.Cookies["UserIdNew"].Value);
                userID = 117;
            }
            else
            {
                userID = 117;
                //System.Web.HttpContext.Current.Request.Cookies["UserIdNew"].Value = "117";
            }
        }
        
    }
    */
    [WebMethod]
    public List<String> ExportProductList(int userId)
    {
        List<String> result = new List<string>();
        result = DBHandler.GetInstance().Shopping_list_proc(userId).ToList<String>();
        return result;
    }

    [WebMethod]
    public Boolean DeleteProduct(int userId, int productId)
    {
        Boolean success = false;
        List<String> result = new List<string>();
        success = DBUtils.deleteProduct(userId, productId);
        return success;
    }

    [WebMethod]
    public void UpdateAmount(int product_id, float amount,int userId)
    {
       DBHandler.GetInstance().UpdateProductAmount(product_id, amount, userId);
    }

    [WebMethod]
    public void SetUser(int userId)
    {
        userID = userId;
    }
}
